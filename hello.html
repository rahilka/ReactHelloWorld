<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello World</title>
    <script src="https://unpkg.com/react@latest/dist/react.js"></script>
    <script src="https://unpkg.com/react-dom@latest/dist/react-dom.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  </head>
  <body>
    <!-- We call this a "root" DOM node because everything inside it will be managed by React DOM. -->
    <div id="root"></div>
    <script type="text/babel">

      // State is similar to props, but it is private and fully controlled by the component
      // Local state is a feature available only to classes.

      // function Clock(props) {
      //   return(
      //     <div>
      //       <h1>Hello, word!</h1>
      //       <h2>It is {props.date.toLocaleTimeString()}</h2>
      //     </div>
      //   );
      // }

      // All components are truly isolated
      // Each Clock sets up its own timer and updates independently
      function App() {
        return(
          <div>
            <Clock />
            <Clock />
            <Clock />
          </div>
        )
      }

      function FormattedDate(props) {
        return <h2>It is {props.date.toLocaleTimeString()}</h2>
      }

      // Any state is always owned by some specific component, and any data or UI derived from that state can only affect components "below" them in the tree.

      // Converting a function to a Class:

      class Clock extends React.Component {

        // State is often called local or encapsulated. It is not accessible to any component other than the one that owns and sets it.

        constructor(props) {  //assigns the initial this.state
          super(props);      // Class components should always call the base constructor with props
          this.state = { date: new Date() };
          // The only place where you can assign this.state is the constructor
        }

        // MOUNTING: happens when the component is rendered to the DOM for the first time
        // UNMOUNTING: happens whenever the DOM produced by the component is removed

        // Decalre lifecycle hooks:
        componentDidMount() {
          //runs after the component output has been rendered to the DOM for the first time

          this.timerID = setInterval(
            () => this.tick(),
            1000
          );

        }

        componentWillUnmount() {
          clearInterval(this.timerID);
        }

        tick() {
          this.setState({ //Thanks to the setState() call, React knows the state has changed, and calls render() method again to learn what should be on the screen
            date: new Date()
          });
        }

        render() {
          return (
            <div>
              <h1>Hello, word!</h1>
              <FormattedDate date={this.state.date} />
            </div>
          );
        }

      }


      ReactDOM.render(
        <App />,
        document.getElementById('root')
      );

    </script>
  </body>
</html>
